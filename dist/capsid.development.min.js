var capsid = (function(n) {
  'use strict'
  var t = {}
  function e(n, t) {
    if (!n) throw new Error(t)
  }
  function o(n) {
    e('string' == typeof n, 'The name should be a string'),
      e(!!t[n], 'The coelement of the given name is not registered: '.concat(n))
  }
  var c = document,
    r = new Promise(function(n) {
      var t = function t() {
        'complete' === c.readyState &&
          (n(), c.removeEventListener('readystatechange', t))
      }
      c.addEventListener('readystatechange', t), t()
    }),
    i = c.documentElement,
    a = function(n, e) {
      var r
      n ? (o(n), (r = [n])) : (r = Object.keys(t)),
        r.map(function(n) {
          ;[].map.call((e || c).querySelectorAll(t[n].sel), t[n])
        })
    },
    u = [],
    s = function(n, t, e) {
      n.I$ ||
        (function(n, t) {
          ;(n.I$ = !0),
            (n.N$ = t),
            (n.capsid = E),
            'function' == typeof n.__init__ && n.__init__()
        })(n, e)
      var o = new n()
      return (
        (o.el = t),
        e && (t['C$' + e] = o),
        (n.K$ || []).map(function(n) {
          n(t, o, e)
        }),
        u.forEach(function(n) {
          n(t, o)
        }),
        'function' == typeof o.__mount__ && o.__mount__(),
        o
      )
    },
    l = function(n, o) {
      e(
        'string' == typeof n,
        '`name` of a class component has to be a string.'
      ),
        e(
          'function' == typeof o,
          '`Constructor` of a class component has to be a function'
        )
      var c = ''.concat(n, '-ðŸ’Š'),
        i = function(t, e) {
          var r = t.classList
          r.contains(c) || (r.add(n, c), s(o, t, n))
        }
      ;(i.sel = '.'.concat(n, ':not(.').concat(c, ')')),
        (t[n] = i),
        r.then(function() {
          a(n)
        })
    },
    f = function(n, t) {
      o(n)
      var c = t['C$' + n]
      return (
        e(
          c,
          'no coelement named: '.concat(n, ', on the dom: ').concat(t.tagName)
        ),
        c
      )
    },
    m = function(n, e) {
      return (
        (function(n, e) {
          o(n), t[n](e)
        })(n, e),
        f(n, e)
      )
    },
    p = function(n, t) {
      var e = f(n, t)
      'function' == typeof e.__unmount__ && e.__unmount__(),
        t.classList.remove(n, ''.concat(n, '-ðŸ’Š')),
        (t['K$' + n] || []).forEach(function(n) {
          n.remove()
        }),
        delete t['C$' + n],
        delete e.el
    },
    h = function(n, t) {
      e(
        'function' == typeof n.install,
        'The given capsid module does not have `install` method. Please check the install call.'
      ),
        n.install(E, t || {})
    },
    v = function(n) {
      var t = (arguments.length > 1 && void 0 !== arguments[1]
        ? arguments[1]
        : {}
      ).at
      return function(o) {
        var c = o.key
        o.finisher = function(o) {
          e(
            !!n,
            'Empty event handler is given: constructor='
              .concat(o.name, ' key=')
              .concat(c)
          ),
            (o.K$ = (o.K$ || []).concat(function(e, o, r) {
              var i = 'K$' + r,
                a = function(n) {
                  var r
                  ;(t &&
                    ![].some.call(e.querySelectorAll(t), function(t) {
                      return t === n.target || t.contains(n.target)
                    })) ||
                    ((r = {
                      type: 'event',
                      module: 'ðŸ’Š',
                      color: '#e0407b',
                      e: n,
                      el: e,
                      coelem: o
                    }),
                    'function' == typeof capsidDebugMessage &&
                      capsidDebugMessage(r),
                    o[c](n))
                }
              ;(a.remove = function() {
                e.removeEventListener(n, a)
              }),
                (e[i] = (e[i] || []).concat(a)),
                e.addEventListener(n, a)
            }))
        }
      }
    },
    d = function(n, t, e, o) {
      n.dispatchEvent(new CustomEvent(t, { detail: o, bubbles: e }))
    },
    y = function(n) {
      return function(t) {
        var o = t.descriptor.value,
          c = t.key
        ;(t.finisher = function(t) {
          e(
            !!n,
            'Unable to emits an empty event: constructor='
              .concat(t.name, ' key=')
              .concat(c)
          )
        }),
          (t.descriptor.value = function() {
            var t = this,
              e = o.apply(this, arguments),
              c = function(e) {
                return d(t.el, n, !0, e)
              }
            return e && e.then ? e.then(c) : c(e), e
          })
      }
    },
    _ = i.matches || i.webkitMatchesSelector || i.msMatchesSelector,
    g = function(n) {
      return function(t) {
        var e = t.key
        ;(t.placement = 'prototype'),
          (t.finisher = function(t) {
            Object.defineProperty(t.prototype, e, {
              get: function() {
                return this.el.querySelector(n)
              }
            })
          })
      }
    }
  ;(g.all = function(n) {
    return function(t) {
      var e = t.key
      ;(t.placement = 'prototype'),
        (t.finisher = function(t) {
          Object.defineProperty(t.prototype, e, {
            get: function() {
              return this.el.querySelectorAll(n)
            }
          })
        })
    }
  }),
    (g.component = function(n, t) {
      return function(o) {
        var c = t || '.'.concat(n),
          r = o.key
        ;(o.placement = 'prototype'),
          (o.finisher = function(t) {
            Object.defineProperty(t.prototype, r, {
              get: function() {
                if (
                  (e(
                    !!this.el,
                    "Component's element is not ready. Probably wired getter called at constructor.(class=[".concat(
                      this.constructor.name,
                      ']'
                    )
                  ),
                  _.call(this.el, c))
                )
                  return f(n, this.el)
                var t = this.el.querySelectorAll(c)
                return (
                  e(
                    t.length > 0,
                    'wired component "'
                      .concat(n, '" is not available at ')
                      .concat(this.el.tagName, '(class=[')
                      .concat(this.constructor.name, ']')
                  ),
                  f(n, t[0])
                )
              }
            })
          })
      }
    })
  var b = function(n) {
      return (
        e(!!n, 'Component name must be non-empty'),
        function(t) {
          t.finisher = function(t) {
            l(n, t)
          }
        }
      )
    },
    k = function(n, t) {
      return function(o) {
        var c = o.key,
          r = o.descriptor,
          i = r.value
        ;(o.finisher = function(t) {
          e(
            !!n,
            'Unable to notify empty event: constructor='
              .concat(t.name, ' key=')
              .concat(c)
          )
        }),
          (r.value = function() {
            var e = this,
              o = i.apply(this, arguments),
              c = [].forEach,
              r = function(o) {
                c.call(e.el.querySelectorAll(t), function(t) {
                  return d(t, n, !1, o)
                })
              }
            return o && o.then ? o.then(r) : r(o), o
          })
      }
    }
  ;(v.useHandler = function(n) {
    ;(v[n] = v(n)).at = function(t) {
      return v(n, { at: t })
    }
  }),
    v.useHandler('click')
  var E = Object.freeze({
    def: l,
    prep: a,
    make: m,
    mount: s,
    unmount: p,
    get: f,
    install: h,
    on: v,
    emits: y,
    wired: g,
    component: b,
    notifies: k,
    __ccc__: t,
    pluginHooks: u
  })
  return (
    (n.def = l),
    (n.prep = a),
    (n.make = m),
    (n.mount = s),
    (n.unmount = p),
    (n.get = f),
    (n.install = h),
    (n.on = v),
    (n.emits = y),
    (n.wired = g),
    (n.component = b),
    (n.notifies = k),
    (n.__ccc__ = t),
    (n.pluginHooks = u),
    n
  )
})({})
